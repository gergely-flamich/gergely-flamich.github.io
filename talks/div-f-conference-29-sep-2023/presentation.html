<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Relative Entropy Coding with Greedy Poisson Rejection Sampling</title>
<meta name="author" content="Gergely Flamich"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/theme/white.css" id="theme"/>


<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/npm/reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h2>Relative Entropy Coding with Greedy Poisson Rejection Sampling</h2><h2></h2></br><h4>Gergely Flamich</h4><h4>29/09/2023</h4>
</section>

<section id="slide-orgd69f0cb">
<h2 id="orgd69f0cb"><span class="section-number-2">1.</span> In Collaboration With</h2>
<img src="./img/collaborators/jiajun_he.jpg" width=23% >
<img src="./img/collaborators/zongyu_guo.jpg" width=23%>
<img src="./img/collaborators/daniel_goc.jpg" width=23%>
<img src="./img/collaborators/miguel_hernandez_lobato.png" width=23%>

</section>
<section id="slide-orga6be35b">
<h2 id="orga6be35b"><span class="section-number-2">2.</span> Background</h2>
<div class="outline-text-2" id="text-2">
</div>
</section>
<section id="slide-org7fe4d13">
<h3 id="org7fe4d13"><span class="section-number-3">2.1.</span> Lossy compression</h3>

<div id="orgf91eb2f" class="figure">
<p><img src="./img/jpeg_example/transform_encoding.png" alt="transform_encoding.png" class="fragment (appear)" />
</p>
</div>


<div id="org97de96d" class="figure">
<p><img src="./img/jpeg_example/transform_decoding.png" alt="transform_decoding.png" class="fragment (appear)" />
</p>
</div>


</section>
<section id="slide-org9df48c0">
<h3 id="org9df48c0"><span class="section-number-3">2.2.</span> Transform Coding as a Channel</h3>
<p class="fragment (appear)">
Get an image \(Y \sim P_Y\)
</p>

<p class="fragment (appear)">
Transform and quantize: \(X = \lfloor f(Y) \rfloor\)
</p>

<p class="fragment (appear)">
Inverse transform to reconstruct: \(\hat{Y} = g(X)\)
</p>

<p class="fragment (appear)">
What can we say about \(P_{X \mid Y}\)? Could we control it?
</p>


</section>
<section id="slide-orgadd1f07">
<h3 id="orgadd1f07"><span class="section-number-3">2.3.</span> Relative Entropy Coding/Channel Simulation</h3>
<p class="fragment (appear)">
Correlated r.v.s \(X, Y \sim P_{X, Y}\)
</p>

<p class="fragment (appear)">
Alice receives \(Y \sim P_Y\)
</p>

<p class="fragment (appear)">
Bob wants to simulate \(X \sim P_{X \mid Y}\)
</p>

<p class="fragment (appear)">
How many bits does Alice need to send to Bob?
</p>

</section>
<section id="slide-org96add8c">
<h3 id="org96add8c"><span class="section-number-3">2.4.</span> Relative Entropy Coding/Channel Simulation</h3>
<p class="fragment (appear)">
How many bits does Alice need to send to Bob?
</p>

<p class="fragment (appear)">
When common randomness \(S\) available:
\[
H[X \mid S] \leq I[X; Y] + \log (I[X; Y] + 1) + 4.
\]
</p>

<p class="fragment (appear)">
\(H[X]\) - Amount of information in \(P_X\)
</p>

<p class="fragment (appear)">
\(I[X; Y]\) - Information in \(P_{X, Y}\) compared to \(P_X \otimes P_Y\)
</p>

<p class="fragment (appear)">
\(I[X; Y]\) can be <b>finite</b> even when \(H[X]\) is <b>infinite</b>!
</p>

</section>
<section id="slide-org0ed467b">
<h2 id="org0ed467b"><span class="section-number-2">3.</span> Applications of Relative Entropy Coding</h2>
<div class="outline-text-2" id="text-3">
</div>
</section>
<section id="slide-orgb2bf60f">
<h3 id="orgb2bf60f"><span class="section-number-3">3.1.</span> Lossy Compression with Realism Constraints</h3>
<ul>
<li>Theis &amp; Agustsson (2021):
<ul>
<li>REC provably better than quantization.</li>

</ul></li>
<li>Theis et al. (2022):</li>

</ul>
<img src="./img/applications/diffC.png" class="r-stretch" data-transition="appear">

</section>
<section id="slide-orgc86b40d">
<h3 id="orgc86b40d"><span class="section-number-3">3.2.</span> Model Compression</h3>
<img src="./img/applications/variational_bnn.png" class="r-stretch">
<ul>
<li class="fragment appear">Dataset \(\mathcal{D} \sim P_{\mathcal{D}}\)</li>
<li class="fragment appear">NN \(f(w, x)\) with weights \(w\) with prior \(P_w\)</li>
<li class="fragment appear">Train weight posterior \(P_{w \mid \mathcal{D}}\) using ELBO</li>
<li class="fragment appear">Encode \(w \sim P_{w \mid \mathcal{D}}\) in \(I[w; \mathcal{D}]\) bits</li>

</ul>

<p class="fragment (appear)">
Image from Blundell et al. (2015)
</p>

</section>
<section id="slide-orgf161b08">
<h3 id="orgf161b08"><span class="section-number-3">3.3.</span> Model Compression</h3>
<p>
Havasi et al. (2018): MIRACLE
</p>
<img src="./img/applications/miracle.png" class="r-stretch">

</section>
<section id="slide-org47a206c">
<h3 id="org47a206c"><span class="section-number-3">3.4.</span> Data Compression with INRs</h3>
<img src="./img/applications/coin.png" class="r-stretch">
<p>
Image from Dupont et al. (2021)
</p>

<p class="fragment (appear)">
<b>Problem</b>: Post-training quantization severely impacts performance!
</p>

</section>
<section id="slide-orge2220ae">
<h3 id="orge2220ae"><span class="section-number-3">3.5.</span> Compress variational INRs!</h3>
<p>
<b>COMBINER</b>: COMpression with Bayesian Implicit Neural Representations
</p>

<img src="./img/applications/recombiner.png" width="100%">

</section>
<section id="slide-org2721aaa">
<h2 id="org2721aaa"><span class="section-number-2">4.</span> Current limitations of REC</h2>
<p class="fragment (appear)">
Current REC algorithms are:
</p>
<ul>
<li class="fragment appear">Too slow (Agustsson &amp; Theis, 2020):
<ul>
<li>Average runtime of any general REC algorithm must scale at least \(2^{I[X; Z]}\)</li>

</ul></li>
<li class="fragment appear">Too limited:
<ul>
<li>Uniforms only (Agustsson &amp; Theis, 2020)</li>
<li>1D unimodal distributions only (F et al., 2022)</li>

</ul></li>
<li class="fragment appear">Too much codelength overhead</li>

</ul>

<p class="fragment (appear)">
<b>Open problem:</b> \(\mathcal{O}(I[X; Z])\) runtime when both \(P_{Z \mid X}\) and \(P_Z\) are multivariate Gaussian?
</p>

</section>
<section id="slide-org100c7e4">
<h2 id="org100c7e4"><span class="section-number-2">5.</span> Take home message: Overview and Applications</h2>
<ul>
<li class="fragment appear">REC is a stochastic compression framework</li>
<li class="fragment appear">Alternative to quantization and entropy coding</li>
<li class="fragment appear">It finds applications in:
<ul>
<li>Lossy compression with realism constraints</li>
<li>Model compression</li>
<li>Compressing Bayesian INRs</li>

</ul></li>
<li class="fragment appear">Currently still too slow or limited</li>

</ul>


</section>
<section id="slide-org315cb6d">
<h2 id="org315cb6d"><span class="section-number-2">6.</span> Greedy Poisson Rejection Sampling</h2>
<div class="outline-text-2" id="text-6">
</div>
</section>
<section id="slide-org0498358">
<h3 id="org0498358"><span class="section-number-3">6.1.</span> Poisson Processes</h3>
<ul>
<li class="fragment appear">Collection of random points in space</li>
<li class="fragment appear">Focus on spatio-temporal processes on \(\mathbb{R}^D \times \mathbb{R}^+\)</li>
<li class="fragment appear">Exponential inter-arrival times</li>
<li class="fragment appear">Spatial distribution \(P_{X \mid T}\)</li>

</ul>

</section>
<section id="slide-org9191a82">
<h3 id="org9191a82"><span class="section-number-3">6.2.</span> Example with \(P_{X \mid T} = \mathcal{N}(0, 1)\)</h3>

<div id="orgbc524e6" class="figure">
<p><img src="./img/pp/empty_pp.png" alt="empty_pp.png" />
</p>
</div>

</section>
<section id="slide-org168a948">
<h3 id="org168a948"><span class="section-number-3">6.3.</span> Example with \(P_{X \mid T} = \mathcal{N}(0, 1)\)</h3>

<div id="orge858c29" class="figure">
<p><img src="./img/pp/pp_t1.png" alt="pp_t1.png" />
</p>
</div>

</section>
<section id="slide-orgf185fad">
<h3 id="orgf185fad"><span class="section-number-3">6.4.</span> Example with \(P_{X \mid T} = \mathcal{N}(0, 1)\)</h3>

<div id="orgb4d5c83" class="figure">
<p><img src="./img/pp/pp_x1.png" alt="pp_x1.png" />
</p>
</div>

</section>
<section id="slide-org13e9910">
<h3 id="org13e9910"><span class="section-number-3">6.5.</span> Example with \(P_{X \mid T} = \mathcal{N}(0, 1)\)</h3>

<div id="orgb302302" class="figure">
<p><img src="./img/pp/pp_t1_x1.png" alt="pp_t1_x1.png" />
</p>
</div>

</section>
<section id="slide-orgb848123">
<h3 id="orgb848123"><span class="section-number-3">6.6.</span> Example with \(P_{X \mid T} = \mathcal{N}(0, 1)\)</h3>

<div id="org96a4bfb" class="figure">
<p><img src="./img/pp/pp_t2.png" alt="pp_t2.png" />
</p>
</div>

</section>
<section id="slide-org68988e0">
<h3 id="org68988e0"><span class="section-number-3">6.7.</span> Example with \(P_{X \mid T} = \mathcal{N}(0, 1)\)</h3>

<div id="org98bcb02" class="figure">
<p><img src="./img/pp/pp_x2.png" alt="pp_x2.png" />
</p>
</div>

</section>
<section id="slide-org1fc757d">
<h3 id="org1fc757d"><span class="section-number-3">6.8.</span> Example with \(P_{X \mid T} = \mathcal{N}(0, 1)\)</h3>

<div id="org3d72107" class="figure">
<p><img src="./img/pp/pp_t2_x2.png" alt="pp_t2_x2.png" />
</p>
</div>

</section>
<section id="slide-org93e4fee">
<h3 id="org93e4fee"><span class="section-number-3">6.9.</span> Example with \(P_{X \mid T} = \mathcal{N}(0, 1)\)</h3>

<div id="org2411189" class="figure">
<p><img src="./img/pp/pp_sim.png" alt="pp_sim.png" />
</p>
</div>


</section>
<section id="slide-org4b9b7c3">
<h3 id="org4b9b7c3"><span class="section-number-3">6.10.</span> Greedy Poisson Rejection Sampling</h3>

</section>
<section id="slide-org3d2b407">
<h3 id="org3d2b407"><span class="section-number-3">6.11.</span> GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="org661d66b" class="figure">
<p><img src="./img/gprs/gprs_0.png" alt="gprs_0.png" />
</p>
</div>

</section>
<section id="slide-orgab8242c">
<h3 id="orgab8242c"><span class="section-number-3">6.12.</span> GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="orgb6d4049" class="figure">
<p><img src="./img/gprs/gprs_1.png" alt="gprs_1.png" />
</p>
</div>

</section>
<section id="slide-org081f063">
<h3 id="org081f063"><span class="section-number-3">6.13.</span> GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="orgafb6e8d" class="figure">
<p><img src="./img/gprs/gprs_2.png" alt="gprs_2.png" />
</p>
</div>

</section>
<section id="slide-org5cefebf">
<h3 id="org5cefebf"><span class="section-number-3">6.14.</span> GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="org8e53767" class="figure">
<p><img src="./img/gprs/gprs_3.png" alt="gprs_3.png" />
</p>
</div>

</section>
<section id="slide-org5f4cd5f">
<h3 id="org5f4cd5f"><span class="section-number-3">6.15.</span> GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="org568c652" class="figure">
<p><img src="./img/gprs/gprs_4.png" alt="gprs_4.png" />
</p>
</div>

</section>
<section id="slide-orgd0f93a6">
<h3 id="orgd0f93a6"><span class="section-number-3">6.16.</span> GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="orgf10ec02" class="figure">
<p><img src="./img/gprs/gprs_5.png" alt="gprs_5.png" />
</p>
</div>

</section>
<section id="slide-org1317c4f">
<h3 id="org1317c4f"><span class="section-number-3">6.17.</span> GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="org4c9c791" class="figure">
<p><img src="./img/gprs/gprs_accept.png" alt="gprs_accept.png" />
</p>
</div>

</section>
<section id="slide-org47d1c17">
<h3 id="org47d1c17"><span class="section-number-3">6.18.</span> How to find the function?</h3>
<p class="fragment (appear)">
\[
\sigma(h) = \int_0^h \frac{1}{w_Q(\eta) - \eta \cdot w_P(\eta)} \, d\eta,
\]
</p>
<p class="fragment (appear)">
where
\[
w_P(h) = \mathbb{P}_{Z \sim P}\left[\frac{dQ}{dP}(Z) \geq h \right]
\]
\[
w_Q(h) = \mathbb{P}_{Z \sim Q}\left[\frac{dQ}{dP}(Z) \geq h \right]
\]
</p>

</section>
<section id="slide-org7ed635d">
<h3 id="org7ed635d"><span class="section-number-3">6.19.</span> Analysis of GPRS</h3>
<p class="fragment (appear)">
<b>Codelength</b>
</p>
<div class="fragment (appear)">
\begin{align}
H[X \mid S] &\leq I[X; Y] + \log (I[X; Y] + 1) \\
&\quad + 2 + \frac{1}{1 + I[X; Y] \cdot \ln 2}
\end{align}

</div>

<p class="fragment (appear)">
<b>Runtime</b>
</p>

<p class="fragment (appear)">
\[
\mathbb{E}[K \mid Y] = \exp(D_{\inf}[P_{X \mid Y} \Vert P_X])
\]
</p>

</section>
<section id="slide-org15935ad">
<h3 id="org15935ad"><span class="section-number-3">6.20.</span> Speeding up GPRS</h3>

<div id="orgf7c86c0" class="figure">
<p><img src="./img/gprs/gprs_accept.png" alt="gprs_accept.png" />
</p>
</div>

</section>
<section id="slide-org897e972">
<h3 id="org897e972"><span class="section-number-3">6.21.</span> Fast GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="orgae32f97" class="figure">
<p><img src="./img/fast_gprs/fast_gprs_0.png" alt="fast_gprs_0.png" />
</p>
</div>
</section>
<section id="slide-org8ab1f6f">
<h3 id="org8ab1f6f"><span class="section-number-3">6.22.</span> Fast GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="org6b8bad4" class="figure">
<p><img src="./img/fast_gprs/fast_gprs_1.png" alt="fast_gprs_1.png" />
</p>
</div>
</section>
<section id="slide-orgb0a9a67">
<h3 id="orgb0a9a67"><span class="section-number-3">6.23.</span> Fast GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="orgff1fd32" class="figure">
<p><img src="./img/fast_gprs/fast_gprs_2.png" alt="fast_gprs_2.png" />
</p>
</div>
</section>
<section id="slide-org38995c6">
<h3 id="org38995c6"><span class="section-number-3">6.24.</span> Fast GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="org12b387c" class="figure">
<p><img src="./img/fast_gprs/fast_gprs_3.png" alt="fast_gprs_3.png" />
</p>
</div>
</section>
<section id="slide-orged8ce31">
<h3 id="orged8ce31"><span class="section-number-3">6.25.</span> Fast GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="org0addf4e" class="figure">
<p><img src="./img/fast_gprs/fast_gprs_4.png" alt="fast_gprs_4.png" />
</p>
</div>
</section>
<section id="slide-org0ba4909">
<h3 id="org0ba4909"><span class="section-number-3">6.26.</span> Fast GPRS with \(P = \mathcal{N}(0, 1), Q = \mathcal{N}(1, 1/16)\)</h3>

<div id="org4605380" class="figure">
<p><img src="./img/fast_gprs/fast_gprs_5.png" alt="fast_gprs_5.png" />
</p>
</div>

</section>
<section id="slide-org9289461">
<h3 id="org9289461"><span class="section-number-3">6.27.</span> Analysis of faster GPRS</h3>
<p class="fragment (appear)">
Now, encode search path \(\pi\).
</p>

<p class="fragment (appear)">
\(H[\pi] \leq I[X; Z] + \log(I[X; Z] + 1) + \mathcal{O}(1)\)
</p>

<p class="fragment (appear)">
\(\mathbb{E}[\lvert\pi\rvert] = \mathcal{O}(I[X; Z])\)
</p>

</section>
<section id="slide-org3a7c2ce">
<h2 id="org3a7c2ce"><span class="section-number-2">7.</span> References</h2>
<div class="outline-text-2" id="text-7">
</div>
</section>
<section id="slide-org7b26aef">
<h3 id="org7b26aef"><span class="section-number-3">7.1.</span> References I</h3>
<ul>
<li>E. Agustsson and L. Theis. "Universally quantized neural compression" In NeurIPS 2020.</li>
<li>C. Blundell, J. Cornebise, K. Kavukcuoglu and D. Wierstra. Weight uncertainty in neural network. In ICML 2015.</li>
<li>E. Dupont, A. Golinski, M. Alizadeh, Y. W. Teh and Arnaud Doucet. "COIN: compression with implicit neural representations" arXiv preprint arXiv:2103.03123, 2021.</li>

</ul>

</section>
<section id="slide-org7032e65">
<h3 id="org7032e65"><span class="section-number-3">7.2.</span> References II</h3>
<ul>
<li>G. F. “Greedy Poisson Rejection Sampling” NeurIPS 2023, to appear.</li>
<li>G. F.*, S. Markou*, and J. M. Hernandez-Lobato. "Fast relative entropy coding with A* coding". In ICML 2022.</li>
<li>D. Goc and G. F. “On Channel Simulation Conjectures” unpublished.</li>

</ul>

</section>
<section id="slide-org80a29a5">
<h3 id="org80a29a5"><span class="section-number-3">7.3.</span> References III</h3>
<ul>
<li>Z. Guo*, G. F.*, J. He, Z. Chen and J. M. Hernandez Lobato, “Compression with Bayesian Implicit Neural Representations” NeurIPS 2023, to appear.</li>
<li>P. Harsha, R. Jain, D. McAllester, and J. Radhakrishnan, “The communication complexity of correlation,” IEEE Transactions on Information Theory, vol. 56, no. 1, pp. 438–449, 2010.</li>
<li>M. Havasi, R. Peharz, and J. M. Hernández-Lobato. "Minimal Random Code Learning: Getting Bits Back from Compressed Model Parameters" In ICLR 2019.</li>

</ul>

</section>
<section id="slide-orgb445e20">
<h3 id="orgb445e20"><span class="section-number-3">7.4.</span> References IV</h3>
<ul>
<li>J. He*, G. F.*, Z. Guo and J. M. Hernandez Lobato, “RECOMBINER: Robust and Enhanced Compression with Bayesian Implicit Neural Representations” unpublished.</li>
<li>C. T. Li and A. El Gamal, “Strong functional representation lemma and applications to coding theorems,” IEEE Transactions on Information Theory, vol. 64, no. 11, pp. 6967–6978, 2018.</li>

</ul>

</section>
<section id="slide-org8dccc41">
<h3 id="org8dccc41"><span class="section-number-3">7.5.</span> References V</h3>
<ul>
<li>L. Theis and E. Agustsson. On the advantages of stochastic encoders. arXiv preprint arXiv:2102.09270.</li>
<li>L. Theis, T. Salimans, M. D. Hoffman and F. Mentzer (2022). Lossy compression with Gaussian diffusion. arXiv preprint arXiv:2206.08889.</li>

</ul>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
slideNumber:'c/t', transition:'none',

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]

});

</script>
</body>
</html>
